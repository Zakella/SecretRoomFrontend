@if (product()) {
  <section class="product-page" appFadeUp>
    <button class="back-btn-mobile" (click)="navigateToList()" aria-label="Назад">
      <img src="assets/images/back.svg" alt="Назад" />
    </button>
    <button class="add-to-cart-mobile" (click)="addProductInCart()" aria-label="Add to cart">
      <i class="pi pi-shopping-bag"></i>
    </button>

    <button class="back-btn-desktop" (click)="navigateToList()">
      <i class="ri-arrow-left-line"></i>
      <span>{{ 'Back' | transloco }}</span>
    </button>

    <div class="product-grid">
      <div class="product-images">
        <div class="main-image">
          <img [src]="mainImage" [alt]="product() | localizedName"/>
        </div>
        @defer {
          <div class="thumbnails">
            @for (image of product()!.productImagesWebStore; track image) {
              <img src="{{image.imageUrl}}"
                   [alt]="(product() | localizedName) + ' - ' + ($index + 1)"
                   loading="lazy"
                   [ngClass]="{'active': mainImage === image.imageUrl}"
                   (click)="mainImage = image.imageUrl || 'assets/images/unavailable.jpg'"
              />
            }
          </div>
        }
      </div>

        <div class="product-info">
          <div class="product-header">
            <span class="brand">{{ product()?.brandAlias }}</span>
            <h1>{{ product() | localizedName }}</h1>

            <div class="price-block" [class.has-discount]="hasDiscount()">
              @if (hasDiscount()) {
                <span class="old-price">{{ product()?.oldPrice }} MDL</span>
              }
              <p class="price" [class.sale-price]="hasDiscount()">
                <span class="amount">{{ product()?.price }}</span>
                <span class="currency">MDL</span>
              </p>
            </div>

            @if (product()?.article) {
              <span class="article">{{ 'Article' | transloco }}: {{ product()?.article }}</span>
            }
          </div>

          @if (product() | localizedName:'description') {
            <div class="description" [innerHTML]="product() | localizedName:'description'"></div>
          }

          @if (product()?.size) {
            <span class="article">{{ 'Size' | transloco }}: {{ product()?.size }}</span>
          }

          <div class="actions">
            <button class="add-to-bag-btn" (click)="addProductInCart()">
              <i class="ri-shopping-bag-line"></i>
              <span>{{ 'Add to Cart' | transloco }}</span>
            </button>

            <div class="secondary-actions">
              <button class="btn-secondary btn-wishlist" [class.active]="isFavorite()" (click)="toggleWishlist()">
                <i [class]="isFavorite() ? 'ri-heart-fill' : 'ri-heart-line'"></i>
                {{ isFavorite() ? ('InFavorites' | transloco) : ('AddToFavorites' | transloco) }}
              </button>

              <button class="btn-secondary" (click)="shareModal.open()">
                <i class="ri-share-line"></i>
                {{ 'Share' | transloco }}
              </button>
            </div>
          </div>
        </div>
    </div>

    <recommended-products [productId]="product()?.id || ''" (addTopBag)="addProductInCart()" (addToWishlist)="toggleWishlist()"/>

    <recently-viewed [excludeProductId]="product()?.id || ''"/>
  </section>
}
<app-share-modal #shareModal/>
