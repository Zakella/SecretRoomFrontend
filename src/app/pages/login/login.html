<div class="auth-page">
  <!-- Animated background -->
  <div class="auth-bg">
    <div class="auth-bg-gradient"></div>
    <div class="auth-bg-pattern"></div>
  </div>

  <!-- Language Switcher -->
  <div class="lang-switcher">
    <button
      class="lang-btn"
      [class.active]="activeLang() === 'ro'"
      (click)="switchLang('ro')">
      RO
    </button>
    <button
      class="lang-btn"
      [class.active]="activeLang() === 'ru'"
      (click)="switchLang('ru')">
      RU
    </button>
  </div>

  <div class="auth-container">
    <!-- Logo -->
    <a [routerLink]="['/', activeLang()]" class="auth-logo">Secret Room</a>

    <!-- Form Card -->
    <div class="auth-card">
      <div class="auth-card-header">
        <h1>{{ 'Sign into your account' | transloco }}</h1>
        <p>{{ 'Welcome back! Please enter your details.' | transloco }}</p>
      </div>

      <form [formGroup]="loginForm" (ngSubmit)="submit()" class="auth-form">
        <!-- Email -->
        <div class="form-group" [class.has-error]="isFieldInvalid('email')" [class.has-value]="hasValue('email')">
          <input
            type="email"
            id="email"
            formControlName="email"
            autocomplete="email">
          <label for="email">
            {{ 'Email' | transloco }}
            <span class="required">*</span>
          </label>
          <div class="input-line"></div>
          <i class="ri-mail-line field-icon"></i>
          @if (isFieldInvalid('email')) {
            <span class="error-text">{{ 'Email is required' | transloco }}</span>
          }
        </div>

        <!-- Password -->
        <div class="form-group" [class.has-error]="isFieldInvalid('password')" [class.has-value]="hasValue('password')">
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            formControlName="password"
            autocomplete="current-password">
          <label for="password">
            {{ 'Password' | transloco }}
            <span class="required">*</span>
          </label>
          <div class="input-line"></div>
          <i
            class="field-icon toggle-password"
            [class.ri-eye-line]="!showPassword"
            [class.ri-eye-off-line]="showPassword"
            (click)="showPassword = !showPassword"></i>
          @if (isFieldInvalid('password')) {
            <span class="error-text">{{ 'Password is required' | transloco }}</span>
          }
        </div>

        <!-- Forgot Password -->
        <div class="forgot-password">
          <a (click)="showDialog()">{{ 'Forgot Password' | transloco }}</a>
        </div>

        <!-- Error message -->
        @if (loginService.badCredentials()) {
          <div class="auth-error">
            <i class="ri-error-warning-line"></i>
            {{ 'Unknown username or password' | transloco }}
          </div>
        }

        <!-- Submit -->
        <button type="submit" class="auth-submit" [disabled]="isSubmitting()">
          @if (isSubmitting()) {
            <span class="spinner"></span>
            {{ 'Processing...' | transloco }}
          } @else {
            {{ 'Sign in' | transloco }}
            <i class="ri-arrow-right-line"></i>
          }
        </button>

        <!-- Divider -->
        <div class="auth-divider">
          <span>{{ 'registration.or' | transloco }}</span>
        </div>

        <!-- Register link -->
        <div class="auth-footer">
          <span>{{ 'No account' | transloco }}</span>
          <a [routerLink]="['/', activeLang(), 'registration']" class="auth-link">{{ 'Register here' | transloco }}</a>
        </div>
      </form>
    </div>

    <!-- Back to home -->
    <a [routerLink]="['/', activeLang()]" class="back-home">
      <i class="ri-arrow-left-line"></i>
      {{ 'registration.backToHome' | transloco }}
    </a>
  </div>
</div>

@if (showResetPassword()) {
  <app-reset-password (close)="showResetPassword.set(false)"/>
}
