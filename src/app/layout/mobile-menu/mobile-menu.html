<!-- Bottom Navigation Bar -->
<nav class="bottom-nav">
  <a class="nav-item" [routerLink]="['/', activeLang()]" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
    <div class="icon-wrapper">
      <i class="ri-home-4-line"></i>
      <i class="ri-home-4-fill active-icon"></i>
    </div>
    <span>{{ 'Home' | transloco }}</span>
  </a>

  <a class="nav-item" (click)="openSearch()">
    <div class="icon-wrapper">
      <i class="ri-search-line"></i>
      <i class="ri-search-2-fill active-icon"></i>
    </div>
    <span>{{ 'Search' | transloco }}</span>
  </a>

  <a class="nav-item" (click)="openCart()">
    <div class="icon-wrapper">
      <i class="ri-shopping-bag-3-line"></i>
      <i class="ri-shopping-bag-3-fill active-icon"></i>
      @if (cartCount() > 0) {
        <span class="badge">{{ cartCount() }}</span>
      }
    </div>
    <span>{{ 'Cart' | transloco }}</span>
  </a>

  <a class="nav-item" [routerLink]="['/', activeLang(), 'contacts']" routerLinkActive="active">
    <div class="icon-wrapper">
      <i class="ri-store-2-line"></i>
      <i class="ri-store-2-fill active-icon"></i>
    </div>
    <span>{{ 'Stores' | transloco }}</span>
  </a>
</nav>

<!-- Brands Drawer (Full Screen) -->
<div class="card flex justify-center">
  <p-drawer header="Brands"
            [(visible)]="visible"
            [fullScreen]="true"
            styleClass="catalog-drawer">

    <ng-template pTemplate="header">
      <div class="drawer-custom-header">
        <span class="drawer-title">{{ 'Brands' | transloco }}</span>
        <div class="lang-switch-mobile">
          @for (lang of languages; track lang) {
            <div class="lang-option" [class.active]="activeLang() === lang" (click)="setActiveLang(lang)">
              {{ lang | uppercase }}
            </div>
          }
        </div>
      </div>
    </ng-template>

    <div class="drawer-content">
      <div class="search-container">
        <div class="search-input-wrapper">
          <i class="ri-search-line"></i>
          <input
            type="text"
            [placeholder]="'Search'| transloco"
            [value]="mobileQuery()"
            (input)="onMobileSearchInput($event)"
            (keyup.enter)="onMobileSearch()"
          />
        </div>
      </div>

      @if (mobileQuery().length >= 2) {
        <!-- Search Results in Drawer -->
        @if (searchService.loading()) {
          <div class="mobile-search-loading">
            <div class="mobile-search-spinner"></div>
          </div>
        } @else if (searchService.suggestions().length === 0) {
          <div class="mobile-search-empty">
            {{ 'NothingFound' | transloco }}
          </div>
        } @else {
          <div class="mobile-search-results">
            @for (product of searchService.suggestions(); track product.id) {
              <div class="mobile-search-item" (click)="goToProductFromSearch(product)">
                <div class="mobile-search-img">
                  <img [src]="product.imageURL || 'assets/images/no-image.png'" [alt]="product.name"/>
                </div>
                <div class="mobile-search-info">
                  <span class="mobile-search-brand">{{ product.brandAlias }}</span>
                  <span class="mobile-search-name">{{ product.name }}</span>
                  <div class="mobile-search-price-row">
                    <span class="mobile-search-price">{{ product.price }} MDL</span>
                    @if (product.oldPrice > product.price!) {
                      <span class="mobile-search-old-price">{{ product.oldPrice }} MDL</span>
                    }
                  </div>
                </div>
              </div>
            }
            <button class="mobile-search-show-all" (click)="showAllMobileResults()">
              {{ 'ShowAllResults' | transloco }}
              <i class="ri-arrow-right-line"></i>
            </button>
          </div>
        }
      } @else {
        <!-- Categories (Horizontal Scroll) -->
        @if (categories().length > 0) {
          <div class="categories-scroll-container">
            <div class="categories-scroll">
              @for (cat of categories(); track cat.id) {
                <div class="category-item" (click)="goToCategory(cat)">
                  <div class="cat-icon-circle">
                    <img [src]="cat.imageUrl || 'assets/images/no-image.png'" [alt]="cat.name" />
                  </div>
                  <span class="cat-name">{{ cat.name }}</span>
                </div>
              }
            </div>
          </div>
        }

        <!-- Brands List (Vertical Grid) -->
        @if (brands().length > 0) {
          <div class="brands-grid">
            @for (brand of brands(); track brand.brand) {
              <button class="brand-item" (click)="goToBrandList(brand)">
                {{ brand.brandAlias }}
              </button>
            }
          </div>
        }
      }
    </div>
  </p-drawer>
</div>
